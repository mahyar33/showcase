<!DOCTYPE html>

<html>
<head>
  <title>CompoundIntl.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="..\..\docco.css" />
</head>
<body>
  <div class="container">
    
      <div class="toc">
        <h3>Table of Contents</h3>
        <ul>
          
          
          
            
            
            
            
            <li class="indent0">
              <a class="source" href="..\..\README.html">
                README.md
              </a>
            </li>
          
            
            
            
              
              
                
                  <h4 class="indent0">misc/</h4>
                
              
                
                  <h4 class="indent1">tutorials/</h4>
                
              
              
            
            
            <li class="indent2">
              <a class="source" href="..\..\misc\tutorials\networkInstallation.html">
                networkInstallation.md
              </a>
            </li>
          
            
            
            
              
              
                
                  <h4 class="indent0">src/</h4>
                
              
              
            
            
            <li class="indent1">
              <a class="source" href="..\App.html">
                App.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent1">
              <a class="source" href="..\App.test.html">
                App.test.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent1">
              <a class="source" href="..\index.html">
                index.js
              </a>
            </li>
          
            
            
            
              
              
                
              
                
                  <h4 class="indent1">network/</h4>
                
              
              
            
            
            <li class="indent2">
              <a class="source" href="..\network\HttpRequest.html">
                HttpRequest.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent2">
              <a class="source" href="..\network\SocketConnection.html">
                SocketConnection.js
              </a>
            </li>
          
            
            
            
              
              
                
              
                
                  <h4 class="indent1">routes/</h4>
                
              
              
            
            
            <li class="indent2">
              <a class="source" href="..\routes\PrivateRoute.html">
                PrivateRoute.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent2">
              <a class="source" href="..\routes\PublicRoute.html">
                PublicRoute.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent2">
              <a class="source" href="..\routes\RedirectIndex.html">
                RedirectIndex.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent2">
              <a class="source" href="..\routes\Routes.html">
                Routes.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent2">
              <a class="source" href="..\routes\authorizedRoutes.html">
                authorizedRoutes.js
              </a>
            </li>
          
            
            
            
              
              
                
              
              
            
            
            <li class="indent1">
              <a class="source" href="..\serviceWorker.html">
                serviceWorker.js
              </a>
            </li>
          
            
            
            
              
              
                
              
                
                  <h4 class="indent1">utils/</h4>
                
              
              
            
            
            <li class="indent2">
              <a class="source" href="CompoundIntl.html">
                CompoundIntl.js
              </a>
            </li>
          
            
            
            
            
            <li class="indent2">
              <a class="source" href="Security.html">
                Security.js
              </a>
            </li>
          
        </ul>
      </div>
    
    <div class="page">
      <div class="header">
        
          <h1>CompoundIntl.js</h1>
        
      </div>

      
        
        
        
          <div class='highlight'><pre><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> globSync = <span class="hljs-built_in">require</span>(<span class="hljs-string">'glob'</span>);
<span class="hljs-keyword">const</span> mkdirpSync = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mkdirp'</span>);



<span class="hljs-keyword">const</span> MESSAGES_PATTERN = {  <span class="hljs-attr">en</span>:<span class="hljs-string">'./src/**/en.json'</span>,<span class="hljs-attr">fa</span>:<span class="hljs-string">'./src/**/fa.json'</span>};
<span class="hljs-keyword">const</span> LANG_DIR         = <span class="hljs-string">'./src/assets/translations/'</span>;</pre></div>
        
      
        
        <p>Aggregates the default messages that were extracted from the example app’s
React components via the React Intl Babel plugin. An error will be thrown if
there are messages in different components that use the same <code>id</code>. The result
is a flat collection of <code>id: message</code> pairs for the app’s default locale.</p>

        
          <div class='highlight'><pre><span class="hljs-built_in">Object</span>.keys(MESSAGES_PATTERN).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key, index</span>)  </span>{
    <span class="hljs-keyword">let</span> defaultMessages = globSync.sync(MESSAGES_PATTERN[key])
        .map(<span class="hljs-function">(<span class="hljs-params">filename</span>) =&gt;</span> fs.readFileSync(filename, <span class="hljs-string">'utf8'</span>))
        .map(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> <span class="hljs-built_in">JSON</span>.parse(file))
        .reduce(<span class="hljs-function">(<span class="hljs-params">collection, descriptors</span>) =&gt;</span> {
            descriptors.forEach(<span class="hljs-function">(<span class="hljs-params">{id, defaultMessage}</span>) =&gt;</span> {
                <span class="hljs-keyword">if</span> (collection.hasOwnProperty(id)) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Duplicate message id: <span class="hljs-subst">${id}</span>`</span>);
                }

                collection[id] = defaultMessage;
            });

            <span class="hljs-keyword">return</span> collection;
        }, {});


    mkdirpSync.sync(LANG_DIR);
    fs.writeFileSync(LANG_DIR +<span class="hljs-string">'main-'</span>+ key+<span class="hljs-string">'.json'</span>, <span class="hljs-built_in">JSON</span>.stringify(defaultMessages, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'&lt;---- Translation file merged ---&gt;'</span>);
})</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
